<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>0.5</title>
</head>
<body>

<iframe
  id="miIframe"
  src="https://huevitohosting.wixsite.com/huevito-games"
  width="100%"
  height="600"
  style="border:none;"
></iframe>

<script>
const iframe = document.getElementById("miIframe");

// Guardamos la URL inicial del iframe
let lastURL = iframe.src;

iframe.addEventListener("load", () => {
  try {
    // Cada vez que el iframe se recarga
    console.log("El iframe se ha recargado");

    // Detectamos que ha cambiado (recargado)
    if (iframe.src !== lastURL) {
      lastURL = iframe.src;
    }

    // Tomamos el último segmento de la URL inicial (no cross-origin)
    const urlObj = new URL(lastURL);
    const pathSegments = urlObj.pathname.split("/").filter(Boolean);
    const lastPart = pathSegments.pop();

    if (lastPart) {
      // Redirigir la página padre al mismo dominio con el último segmento
      window.location.href = window.location.origin + "/" + lastPart;
    }

  } catch (e) {
    // Ventana de error
    const errorWindow = window.open("", "Error", "width=600,height=400");
    errorWindow.document.write("<h2>Error procesando iframe</h2>");
    errorWindow.document.write("<p>" + e.message + "</p>");
  }
});
</script>

</body>
</html>
