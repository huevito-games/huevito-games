<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Página contenedora</title>
</head>
<body>

<iframe
  id="miIframe"
  src="https://huevitohosting.wixsite.com/huevito-gamess"
  width="100%"
  height="600"
  style="border:none;"
></iframe>

<script>
const iframe = document.getElementById("miIframe");

// Escuchamos mensajes del iframe
window.addEventListener("message", (event) => {
  try {
    // Solo procesamos mensajes de Wix
    if (!event.origin.includes("wixsite.com")) return;

    // Obtenemos la URL enviada por el iframe
    const iframeURL = event.data;
    const urlObj = new URL(iframeURL);

    // Extraemos la última parte de la ruta
    const pathSegments = urlObj.pathname.split("/").filter(Boolean);
    const lastPart = pathSegments.pop();

    if (lastPart) {
      // Redirigir la página principal a la última parte
      const nuevaURL = "https://paginaiframe.com/" + lastPart;
      window.location.href = nuevaURL;
    }
  } catch (e) {
    // Crear ventana de error mostrando el mensaje
    const errorWindow = window.open("", "Error", "width=600,height=400");
    errorWindow.document.write("<h2>Error al procesar postMessage del iframe</h2>");
    errorWindow.document.write("<p>" + e.message + "</p>");
    errorWindow.document.write("<pre>" + e.stack + "</pre>");
  }
});
</script>

</body>
</html>
