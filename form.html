<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario de Contacto</title>
</head>
<body>
  <h1>Formulario de Contacto</h1>
  <form id="miFormulario">
    <input name="Nombre" placeholder="Nombre" required><br><br>
    <input name="Email" type="email" placeholder="Email" required><br><br>
    <textarea name="Mensaje" placeholder="Mensaje"></textarea><br><br>
    <button type="submit">Enviar</button>
  </form>
  <p id="status"></p>

  <script>
    const form = document.getElementById('miFormulario');
    const status = document.getElementById('status');

    const BIN_URL = 'https://api.jsonbin.io/v3/b/69a00ca6d0ea881f40db071b'; // Reemplaza con la URL de tu bin JSONBin
    const API_KEY = '$2a$10$3y8VR2VDt/jBnBtfVZCtiOxM.H/VysD2bCfTrON/ZMaeQJkJE9BiK'; // Reemplaza con tu API Key de JSONBin

    form.addEventListener('submit', async e => {
      e.preventDefault();
      const nuevo = {
        Nombre: form.Nombre.value,
        Email: form.Email.value,
        Mensaje: form.Mensaje.value,
        Fecha: new Date().toLocaleString()
      };

      try {
        // Leer datos existentes
        const resGet = await fetch(BIN_URL + '/latest', {
          headers: { 'X-Master-Key': API_KEY }
        });
        const data = await resGet.json();

        // Agregar nuevo registro
        data.push(nuevo);

        // Guardar de nuevo en el bin
        const resPut = await fetch(BIN_URL, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'X-Master-Key': API_KEY
          },
          body: JSON.stringify(data)
        });

        if(resPut.ok) {
          status.textContent = "✅ Enviado correctamente";
          form.reset();
        } else {
          status.textContent = "❌ Error al enviar";
        }
      } catch(err) {
        console.error(err);
        status.textContent = "❌ Error de red";
      }
    });
  </script>
</body>
</html>
