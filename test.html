<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Control de única pestaña</title>

<script>
(function() {
    const PAGE_KEY = "pagina_unica_abierta";
    const tabId = Date.now() + "_" + Math.random();
    const REDIRECT_URL = "https://huevito-games.github.io/autoclose/";

    // Si ya existe una pestaña activa → redirigir inmediatamente
    if (localStorage.getItem(PAGE_KEY)) {
        window.location.replace(REDIRECT_URL);
        return;
    }

    // Registrar esta pestaña
    localStorage.setItem(PAGE_KEY, tabId);

    // Detectar si otra pestaña toma el control
    window.addEventListener("storage", function(event) {
        if (event.key === PAGE_KEY && event.newValue !== tabId) {
            window.location.replace(REDIRECT_URL);
        }
    });

    // Liberar bloqueo al cerrar
    window.addEventListener("beforeunload", function() {
        if (localStorage.getItem(PAGE_KEY) === tabId) {
            localStorage.removeItem(PAGE_KEY);
        }
    });

})();
</script>

</head>
<body>
<h1>Solo puede haber una pestaña abierta</h1>
</body>
</html>
